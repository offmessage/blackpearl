

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Example 5 (part 2): A more complex stopwatch &mdash; Black Pearl 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Black Pearl 1.0 documentation" href="../index.html"/>
        <link rel="up" title="Examples" href="index.html"/>
        <link rel="next" title="Example scripts that aren’t yet documented" href="examples_no_docs.html"/>
        <link rel="prev" title="Example 5: The Simple Stopwatch" href="example_5.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Black Pearl
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Detailed installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting started with blackpearl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../messages.html">Messages</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="example_1.html">Example 1: Simple interactive light show</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_2.html">Example 2: Making a thermometer</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_3.html">Example 3: Matching colours</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_4.html">Example 4: Mighty Mover</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_5.html">Example 5: The Simple Stopwatch</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Example 5 (part 2): A more complex stopwatch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#step-by-step-example">Step by step example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples_no_docs.html">Example scripts that aren&#8217;t yet documented</a></li>
<li class="toctree-l2"><a class="reference internal" href="plannedexamples.html">Planned examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="examplesbykit.html">Examples broken down by kit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hardware/index.html">Flotilla hardware things</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/index.html"><strong>blackpearl</strong>&#8216;s software things</a></li>
<li class="toctree-l1"><a class="reference internal" href="../blackpearl/index.html"><strong>blackpearl</strong>&#8216;s internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usingidle.html">Using IDLE with <strong>blackpearl</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting your installation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Black Pearl</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Examples</a> &raquo;</li>
      
    <li>Example 5 (part 2): A more complex stopwatch</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/examples/example_5_2.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="example-5-part-2-a-more-complex-stopwatch">
<span id="example5-2"></span><h1>Example 5 (part 2): A more complex stopwatch<a class="headerlink" href="#example-5-part-2-a-more-complex-stopwatch" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This project uses the number display and touch keypad, which come with
the Mega Treasure Chest.</p>
</div>
<p>I said in the last example that we&#8217;d make a more complex stopwatch. This is it.
Instead of just pausing when we press <strong>button 2</strong> this one gives us a <em>lap
time</em> - that is, it flashes the time when you pressed button 2, but the clock
keeps running in the background and when you press button 2 again the display
shows the stopwatch time again.</p>
<p>This replicates the stopwatch behaviour on classic digital watches from the
eighties. Very important to get right, I&#8217;m sure you&#8217;ll agree.</p>
<p>This project starts storing the state of the timer on our own module, rather
than within the Stopwatch thing itself. It gives us more control, but it makes
our code more complicated...</p>
<div class="section" id="step-by-step-example">
<h2>Step by step example<a class="headerlink" href="#step-by-step-example" title="Permalink to this headline">¶</a></h2>
<p>This example can be found in
<a class="reference external" href="https://github.com/offmessage/blackpearl/blob/master/blackpearl/examples/example_5_2.py">blackpearl/examples/example_5_2.py</a>,
but it&#8217;s also included here in its entirety for reference:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">blackpearl.modules</span> <span class="k">import</span> <span class="n">Module</span>
<span class="kn">from</span> <span class="nn">blackpearl.projects</span> <span class="k">import</span> <span class="n">Project</span>
<span class="kn">from</span> <span class="nn">blackpearl.things</span> <span class="k">import</span> <span class="n">Number</span>
<span class="kn">from</span> <span class="nn">blackpearl.things</span> <span class="k">import</span> <span class="n">Stopwatch</span>
<span class="kn">from</span> <span class="nn">blackpearl.things</span> <span class="k">import</span> <span class="n">Touch</span>


<span class="k">class</span> <span class="nc">MyStopwatch</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>

    <span class="n">hardware_required</span> <span class="o">=</span> <span class="p">[</span><span class="n">Number</span><span class="p">,</span> <span class="n">Touch</span><span class="p">,]</span>
    <span class="n">software_required</span> <span class="o">=</span> <span class="p">[</span><span class="n">Stopwatch</span><span class="p">,]</span>
    <span class="n">listening_for</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;stopwatch&#39;</span><span class="p">,</span> <span class="s1">&#39;touch&#39;</span><span class="p">,]</span>

    <span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;STOPPED&#39;</span>
    <span class="n">on</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">display_time</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">set_number</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="s1">&#39;00&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">receive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;stopwatch&#39;</span> <span class="ow">in</span> <span class="n">message</span><span class="p">:</span>
            <span class="n">tm</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;stopwatch&#39;</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;RUNNING&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_time</span> <span class="o">=</span> <span class="n">tm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">set_number</span><span class="p">(</span><span class="n">tm</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="s1">&#39;00&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;PAUSED&#39;</span><span class="p">:</span>
                <span class="n">hundredths</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tm</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">hundredths</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">on</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">set_number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">display_time</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="s1">&#39;00&#39;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

        <span class="k">elif</span> <span class="s1">&#39;touch&#39;</span> <span class="ow">in</span> <span class="n">message</span><span class="p">:</span>
            <span class="n">buttons</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;touch&#39;</span><span class="p">][</span><span class="s1">&#39;buttons&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">buttons</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;STOPPED&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;RUNNING&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">buttons</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;RUNNING&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;STOPPED&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">buttons</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;RUNNING&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;PAUSED&#39;</span>
            <span class="k">elif</span> <span class="n">buttons</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;PAUSED&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;RUNNING&#39;</span>
            <span class="k">elif</span> <span class="n">buttons</span><span class="p">[</span><span class="s1">&#39;4&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PAUSED&#39;</span><span class="p">,</span> <span class="s1">&#39;STOPPED&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;STOPPED&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">set_number</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="s1">&#39;00&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">MyProject</span><span class="p">(</span><span class="n">Project</span><span class="p">):</span>
    <span class="n">required_modules</span> <span class="o">=</span> <span class="p">[</span><span class="n">MyStopwatch</span><span class="p">,</span> <span class="p">]</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">MyProject</span><span class="p">()</span>
</pre></div>
</div>
<p>As with the all of our projects the first thing we need to do is import all the
necessary bits and bobs. For this one they are the basic <code class="docutils literal"><span class="pre">Project</span></code>, the basic
<code class="docutils literal"><span class="pre">Module</span></code> plus the <code class="docutils literal"><span class="pre">Number</span></code>, the <code class="docutils literal"><span class="pre">Touch</span></code> and the <code class="docutils literal"><span class="pre">Stopwatch</span></code> <em>things</em>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">blackpearl.modules</span> <span class="k">import</span> <span class="n">Module</span>
<span class="kn">from</span> <span class="nn">blackpearl.projects</span> <span class="k">import</span> <span class="n">Project</span>
<span class="kn">from</span> <span class="nn">blackpearl.things</span> <span class="k">import</span> <span class="n">Number</span>
<span class="kn">from</span> <span class="nn">blackpearl.things</span> <span class="k">import</span> <span class="n">Stopwatch</span>
<span class="kn">from</span> <span class="nn">blackpearl.things</span> <span class="k">import</span> <span class="n">Touch</span>
</pre></div>
</div>
<p>As before we define our own module, using <strong>blackpearl</strong>&#8216;s <strong>Module</strong> class as
our base class:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyStopwatch</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
</pre></div>
</div>
<p>First we want to make sure that the number displays <code class="docutils literal"><span class="pre">0.00</span></code> before it starts:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">set_number</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="s1">&#39;00&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
<p>We&#8217;re <code class="docutils literal"><span class="pre">listening_for</span></code> messages from the stopwatch <em>and</em> the touch this time,
and we need the number and touch for this to work. For the first time we also
need to define a <code class="docutils literal"><span class="pre">software_required</span></code>, as we&#8217;re using the stopwatch as well:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">hardware_required</span> <span class="o">=</span> <span class="p">[</span><span class="n">Number</span><span class="p">,</span> <span class="n">Touch</span><span class="p">,]</span>
<span class="n">software_required</span> <span class="o">=</span> <span class="p">[</span><span class="n">Stopwatch</span><span class="p">,]</span>
<span class="n">listening_for</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;stopwatch&#39;</span><span class="p">,</span> <span class="s1">&#39;touch&#39;</span><span class="p">,]</span>
</pre></div>
</div>
<p>We also need to define some class attributes to store our state (like we did in
<a class="reference internal" href="example_1.html"><span class="doc">the very first example</span></a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;STOPPED&#39;</span>
<span class="n">on</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">display_time</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>
</div>
<p>This time our <code class="docutils literal"><span class="pre">.receive()</span></code> is called with messages from either the <code class="docutils literal"><span class="pre">touch</span></code>
or the <code class="docutils literal"><span class="pre">stopwatch</span></code>, so we need to have an <code class="docutils literal"><span class="pre">if</span> <span class="pre">...</span> <span class="pre">elif</span> <span class="pre">...</span> <span class="pre">else</span></code> right at
the start of our <code class="docutils literal"><span class="pre">.recieve()</span></code> to decide what to do.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The format of the message that the touch sends is documented on the
<a class="reference internal" href="../hardware/inputs/touch.html#touch-hardware"><span class="std std-ref">Touch&#8217;s page</span></a>.</p>
</div>
<p>The decisions that we take when we get a tick from the stopwatch are a bit more
complicated this time. If our status is <code class="docutils literal"><span class="pre">&quot;RUNNING&quot;</span></code> we want to do what we did
before - display the time - but we also want to store the time we displayed,
just in case it&#8217;s about to be paused:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">receive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39;stopwatch&#39;</span> <span class="ow">in</span> <span class="n">message</span><span class="p">:</span>
        <span class="n">tm</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;stopwatch&#39;</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;RUNNING&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">display_time</span> <span class="o">=</span> <span class="n">tm</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">set_number</span><span class="p">(</span><span class="n">tm</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="s1">&#39;00&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
<p>If, however, our status is <code class="docutils literal"><span class="pre">&quot;PAUSED&quot;</span></code> (because the user has pressed button 2)
then we want to start flashing the display with the time at the moment the user
pressed the button:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;PAUSED&#39;</span><span class="p">:</span>
    <span class="n">hundredths</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tm</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">hundredths</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">set_number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">display_time</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="s1">&#39;00&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">YOU GOT TO HERE. SUGGEST FOR THE PURPOSES OF EXPLAINING THAT YOU
ACTUALLY MOVE THE TOUCH STUFF ABOVE THE STOPWATCH, AS THIS MAKES
MORE SENSE.</p>
</div>
<p>If, however, the message was from the touch we want to take some very different
actions. If it was <strong>button 1</strong> that was pressed, we want to either start or
stop the timer:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">elif</span> <span class="s1">&#39;touch&#39;</span> <span class="ow">in</span> <span class="n">message</span><span class="p">:</span>
    <span class="n">buttons</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;touch&#39;</span><span class="p">][</span><span class="s1">&#39;buttons&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">buttons</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;STOPPED&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">buttons</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;RUNNING&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
<p>If it was <strong>button 2</strong> we want to either pause or unpause the timer:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">elif</span> <span class="n">buttons</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">status</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PAUSED&#39;</span><span class="p">,</span> <span class="s1">&#39;RUNNING&#39;</span><span class="p">]:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">pause</span><span class="p">()</span>
</pre></div>
</div>
<p>And if it was <strong>button 4</strong> we want to reset the timer and show <code class="docutils literal"><span class="pre">0.00</span></code> on the
number display:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">elif</span> <span class="n">buttons</span><span class="p">[</span><span class="s1">&#39;4&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">status</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PAUSED&#39;</span><span class="p">,</span> <span class="s1">&#39;STOPPED&#39;</span><span class="p">]:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stopwatch</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">set_number</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="s1">&#39;00&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
<p>As before, the rest of the script is the bit that makes the whole thing run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyProject</span><span class="p">(</span><span class="n">Project</span><span class="p">):</span>
    <span class="n">required_modules</span> <span class="o">=</span> <span class="p">[</span><span class="n">MyStopwatch</span><span class="p">,]</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">MyProject</span><span class="p">()</span>
</pre></div>
</div>
<p>Now our project will run from within our virtual environment as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">pi</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">blackpearl</span>
<span class="n">source</span> <span class="n">venv</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">activate</span>
<span class="n">python</span> <span class="n">blackpearl</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">example_5</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="examples_no_docs.html" class="btn btn-neutral float-right" title="Example scripts that aren’t yet documented" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="example_5.html" class="btn btn-neutral" title="Example 5: The Simple Stopwatch" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Andy Theyers.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>